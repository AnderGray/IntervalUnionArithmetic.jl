@testset "set operations" begin

    Nsamps = 10^6

    a = interval(0,1) ∪ interval(2,3)
    b = interval(-1, 1) ∪ interval(2,5)

    aSamps = [rand(rand(a.v)) for i=1:Nsamps]
    bSamps = [rand(rand(b.v)) for i=1:Nsamps]

    @test all(aSamps .∈ a)
    @test all(bSamps .∈ b)

    ac = complement(a)

    @test all(.~(aSamps .∈ ac))     # Test all samples are not in complement

    intersec = a ∩ b                 # Intersect

    aSampsB = aSamps[ aSamps .∈ b]
    bSampsA = bSamps[ bSamps .∈ a]

    @test all( aSampsB .∈ intersec)
    @test all( bSampsA .∈ intersec)

    diff = a \ b                 # Set difference

    @test diff[1] == interval(1)
    @test diff[2] == interval(2)

    bi = bisect(a, 0.5)         # Cut at a = 0.5

    @test bi[1] == interval(0, 0.5)
    @test bi[2] == interval(0.5, 1)
    @test bi[3] == interval(2, 3)

    @test a ⊂ interval(0, 3)     # Subset
    @test !(b ⊂ interval(0, 3))


    a = interval(0,360)
    b = intervalUnion([interval(x...) for x in [[2.79673, 8.91372], [39.2939, 56.4471], [67.1466, 70.1468], [80.2861, 93.2176], [110.055, 130.796], [139.832, 142.835], [151.597, 154.8], [175.313, 178.315], [188.508, 200.028], [234.445, 246.861], [272.586, 275.589], [286.656, 298.892], [315.723, 318.724], [333.795, 343.149], [362.617, 372.152], [388.38, 398.013], [420.947, 438.171], [448.538, 451.541], [470.079, 478.298], [494.766, 505.138], [515.836, 521.239], [539.73, 564.545], [582.778, 595.462], [617.058, 621.725], [631.357, 634.36], [644.533, 647.535], [666.469, 670.569], [688.826, 704.525], [713.249, 716.25], [740.816, 745.865], [764.322, 785.23], [794.686, 797.688], [809.239, 812.241], [821.892, 829.197], [845.522, 848.524], [860.125, 881.507], [896.821, 902.851], [913.554, 916.557], [925.626, 928.629] , [937.907, 940.909] , [953.773, 966.779] , [979.707, 982.709] , [992.479, 995.481] , [1004.19, 1007.21] , [1018.72, 1042.07] , [1055.94, 1071.58] , [1091.95, 1105.8] , [1125.04, 1129.45] , [1140.79, 1151.73] , [1160.92, 1172.92] , [1183.24, 1207.91] , [1224.19, 1233.81] , [1252.02, 1255.77] , [1273.52, 1276.54] , [1291.92, 1294.94] , [1307.19, 1319.72] , [1331.31, 1342.02] , [1354.02, 1361.17] , [1371.06, 1379.12] , [1395.09, 1398.11] , [1408.4, 1411.42] , [1421.66, 1430.58] , [1447.54, 1450.56] , [1462.94, 1480.01] , [1507.29, 1515.55] , [1526.6, 1529.62] , [1542.84, 1545.86] , [1559.41, 1562.43] , [1573.36, 1577.9] , [1597.89, 1603.73] , [1623.08, 1646.25] , [1669.9, 1685.05] , [1697.35, 1700.37] , [1722.14, 1748.25] , [1764.96, 1791.44] , [1804.68, 1808.32] , [1840.8, 1853.31] , [1865.21, 1868.23] , [1878.51, 1884.73] , [1901.24, 1904.97] , [1927.78, 1932.05] , [1949.6, 1954.92] , [1972, 1984.02] , [1997.24, 2000.25] , [2013.48, 2043.86] , [2056.4, 2059.43] , [2074.69, 2077.72] , [2086.82, 2089.85] , [2101.82, 2106.68] , [2116.44, 2119.47] , [2135.3, 2148.33] , [2162.94, 2173.99] , [2193.26, 2196.29] , [2206.51, 2225.08] , [2242.53, 2245.54] , [2254.69, 2257.7] , [2274.09, 2289.49] , [2312.13, 2336.16] , [2356.9, 2367.83] , [2376.17, 2383.41]]
])
    @test  a∩b ⊂ a # fix to "Error in intersection" issue #23

end
